<Window x:Class="BlueCloudK.WpfMusicTilesAI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:BlueCloudK.WpfMusicTilesAI"
        xmlns:views="clr-namespace:BlueCloudK.WpfMusicTilesAI.Views"
        xmlns:models="clr-namespace:BlueCloudK.WpfMusicTilesAI.Models"
        mc:Ignorable="d"
        Title="Magic Tiles AI" Height="700" Width="900"
        WindowStartupLocation="CenterScreen"
        Background="#0f0f23">
    <Grid>
        <!-- Setup Instructions Screen (shows if OAuth is not configured) -->
        <Grid x:Name="SetupInstructionsScreen"
              Visibility="{Binding ShowSetupInstructions, Converter={StaticResource BoolToVisibilityConverter}}">
            <Grid.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                    <GradientStop Color="#0f0f23" Offset="0"/>
                    <GradientStop Color="#1a1a2e" Offset="1"/>
                </LinearGradientBrush>
            </Grid.Background>
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" MaxWidth="600">
                <TextBlock Text="⚙️ Setup Required"
                          FontSize="32"
                          FontWeight="Bold"
                          Foreground="White"
                          HorizontalAlignment="Center"
                          Margin="0,0,0,20"/>

                <TextBlock TextWrapping="Wrap"
                          FontSize="16"
                          Foreground="#94a3b8"
                          HorizontalAlignment="Center"
                          Margin="0,0,0,30">
                    <Run Text="To use Magic Tiles AI, you need to configure Google OAuth 2.0 credentials."/>
                    <LineBreak/><LineBreak/>
                    <Run Text="Please follow these steps:" FontWeight="Bold"/>
                </TextBlock>

                <StackPanel Margin="20,0,20,0">
                    <TextBlock TextWrapping="Wrap" FontSize="14" Foreground="#cbd5e1" Margin="0,0,0,10">
                        <Run Text="1. Go to " />
                        <Hyperlink NavigateUri="https://console.cloud.google.com/apis/credentials"
                                  RequestNavigate="Hyperlink_RequestNavigate"
                                  Foreground="#60a5fa">
                            <Run Text="Google Cloud Console"/>
                        </Hyperlink>
                    </TextBlock>

                    <TextBlock Text="2. Create a new OAuth 2.0 Client ID (Desktop app)"
                              TextWrapping="Wrap"
                              FontSize="14"
                              Foreground="#cbd5e1"
                              Margin="0,0,0,10"/>

                    <TextBlock Text="3. Copy your Client ID and Client Secret"
                              TextWrapping="Wrap"
                              FontSize="14"
                              Foreground="#cbd5e1"
                              Margin="0,0,0,10"/>

                    <TextBlock TextWrapping="Wrap" FontSize="14" Foreground="#cbd5e1" Margin="0,0,0,10">
                        <Run Text="4. Add them to "/>
                        <Run Text="App.config" FontFamily="Consolas" Foreground="#f59e0b"/>
                        <Run Text=" file"/>
                    </TextBlock>

                    <Border Background="#1e293b"
                           BorderBrush="#334155"
                           BorderThickness="1"
                           CornerRadius="4"
                           Padding="10"
                           Margin="0,10,0,20">
                        <TextBlock FontFamily="Consolas"
                                  FontSize="12"
                                  Foreground="#e2e8f0"
                                  TextWrapping="Wrap">
                            <Run Text="&lt;add key=&quot;GOOGLE_CLIENT_ID&quot;"/>
                            <LineBreak/>
                            <Run Text="     value=&quot;YOUR_CLIENT_ID.apps.googleusercontent.com&quot;/&gt;"/>
                            <LineBreak/>
                            <Run Text="&lt;add key=&quot;GOOGLE_CLIENT_SECRET&quot;"/>
                            <LineBreak/>
                            <Run Text="     value=&quot;YOUR_CLIENT_SECRET&quot;/&gt;"/>
                        </TextBlock>
                    </Border>

                    <TextBlock Text="5. Restart the application"
                              TextWrapping="Wrap"
                              FontSize="14"
                              Foreground="#cbd5e1"/>
                </StackPanel>

                <TextBlock Text="For detailed instructions, check the README.md file"
                          FontSize="12"
                          Foreground="#64748b"
                          HorizontalAlignment="Center"
                          Margin="0,30,0,0"
                          FontStyle="Italic"/>
            </StackPanel>
        </Grid>

        <!-- Login Screen (shows first if OAuth is configured and not authenticated) -->
        <views:LoginView x:Name="LoginView"
                        Visibility="{Binding ShowLogin, Converter={StaticResource BoolToVisibilityConverter}}"/>

        <!-- Start Screen (only shows when not showing login AND in Start state) -->
        <views:StartView x:Name="StartView"
                        Visibility="{Binding ShowStartView, Converter={StaticResource BoolToVisibilityConverter}}"/>

        <!-- Loading Screen -->
        <Grid x:Name="LoadingScreen"
              Visibility="{Binding CurrentState, Converter={StaticResource GameStateToVisibilityConverter}, ConverterParameter=Loading}">
            <Grid.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                    <GradientStop Color="#0f0f23" Offset="0"/>
                    <GradientStop Color="#1a1a2e" Offset="1"/>
                </LinearGradientBrush>
            </Grid.Background>
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock Text="{Binding LoadingMessage}"
                          FontSize="24"
                          Foreground="White"
                          HorizontalAlignment="Center"
                          Margin="0,0,0,20"/>
                <ProgressBar IsIndeterminate="True"
                            Width="300"
                            Height="4"
                            Background="#2d3748"
                            Foreground="#e94560"/>
                <TextBlock Text="Generating your unique beat map..."
                          FontSize="14"
                          Foreground="#64748b"
                          HorizontalAlignment="Center"
                          Margin="0,20,0,0"/>
            </StackPanel>
        </Grid>

        <!-- Game Screen -->
        <views:GameView x:Name="GameView"
                       Visibility="{Binding CurrentState, Converter={StaticResource GameStateToVisibilityConverter}, ConverterParameter=Playing}"/>
    </Grid>
</Window>
